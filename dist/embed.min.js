/*! flat-embed v0.1.0 | (c) 2017 Tutteo Ltd. (Flat) | Apache-2.0 License | https://github.com/FlatIO/embed-client */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t.Flat=t.Flat||{},t.Flat.Embed=e())}(this,function(){"use strict";function t(t){return t&&t.__esModule?t.default:t}function e(t,e){return e={exports:{}},t(e,e.exports),e.exports}function n(t){if(window.jQuery&&t instanceof window.jQuery&&(t=t[0]),"string"==typeof t&&(t=document.getElementById(t)),!(t instanceof window.HTMLElement))throw new TypeError("The first parameter must be an existing DOM element or an identifier.");if("IFRAME"!==t.nodeName){var e=t.querySelector("iframe");e&&(t=e)}return t}function r(t){var e=t.baseUrl||"https://flat.io/embed";e+="/"+(t.score||"blank");var n=Or({jsapi:!0},t.embedParams);return e+"?"+gr(n).map(function(t){return encodeURIComponent(t)+"="+encodeURIComponent(n[t])}).join("&")}function o(t,e){var n=r(e),o=document.createElement("iframe");return o.setAttribute("src",n),o.setAttribute("width",e.width||"100%"),o.setAttribute("height",e.height||"100%"),o.setAttribute("allowfullscreen",!0),o.setAttribute("frameborder","0"),t.appendChild(o),o}function i(t,e,n){if(!t.element.contentWindow||!t.element.contentWindow.postMessage)throw new Error("No `contentWindow` or `contentWindow.postMessage` avaialble on the element");var r={method:e,parameters:n};t.element.contentWindow.postMessage(r,t.origin)}function u(t){return"string"==typeof t&&(t=JSON.parse(t)),t}var c=Math.ceil,s=Math.floor,a=function(t){return isNaN(t=+t)?0:(t>0?s:c)(t)},f=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t},l=e(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),h=e(function(t){var e=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=e)}),p=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t},v=function(t,e,n){if(p(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,o){return t.call(e,n,r,o)}}return function(){return t.apply(e,arguments)}},d=function(t){return"object"==typeof t?null!==t:"function"==typeof t},y=function(t){if(!d(t))throw TypeError(t+" is not an object!");return t},m=function(t){try{return!!t()}catch(t){return!0}},b=!m(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),g=l.document,_=d(g)&&d(g.createElement),w=function(t){return _?g.createElement(t):{}},O=!b&&!m(function(){return 7!=Object.defineProperty(w("div"),"a",{get:function(){return 7}}).a}),k=function(t,e){if(!d(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!d(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!d(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!d(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")},j=Object.defineProperty,S=b?Object.defineProperty:function(t,e,n){if(y(t),e=k(e,!0),y(n),O)try{return j(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t},E={f:S},M=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},P=b?function(t,e,n){return E.f(t,e,M(1,n))}:function(t,e,n){return t[e]=n,t},A=function(t,e,n){var r,o,i,u=t&A.F,c=t&A.G,s=t&A.S,a=t&A.P,f=t&A.B,p=t&A.W,d=c?h:h[e]||(h[e]={}),y=d.prototype,m=c?l:s?l[e]:(l[e]||{}).prototype;c&&(n=e);for(r in n)(o=!u&&m&&void 0!==m[r])&&r in d||(i=o?m[r]:n[r],d[r]=c&&"function"!=typeof m[r]?n[r]:f&&o?v(i,l):p&&m[r]==i?function(t){var e=function(e,n,r){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,r)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(i):a&&"function"==typeof i?v(Function.call,i):i,a&&((d.virtual||(d.virtual={}))[r]=i,t&A.R&&y&&!y[r]&&P(y,r,i)))};A.F=1,A.G=2,A.S=4,A.P=8,A.B=16,A.W=32,A.U=64,A.R=128;var C=A,x=P,F={}.hasOwnProperty,T=function(t,e){return F.call(t,e)},N={},I={}.toString,W=function(t){return I.call(t).slice(8,-1)},R=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==W(t)?t.split(""):Object(t)},L=function(t){return R(f(t))},J=Math.min,D=function(t){return t>0?J(a(t),9007199254740991):0},U=Math.max,Z=Math.min,z=function(t,e){return t=a(t),t<0?U(t+e,0):Z(t,e)},q=l["__core-js_shared__"]||(l["__core-js_shared__"]={}),B=function(t){return q[t]||(q[t]={})},G=0,K=Math.random(),X=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++G+K).toString(36))},Q=B("keys"),H=function(t){return Q[t]||(Q[t]=X(t))},Y=function(t){return function(e,n,r){var o,i=L(e),u=D(i.length),c=z(r,u);if(t&&n!=n){for(;u>c;)if((o=i[c++])!=o)return!0}else for(;u>c;c++)if((t||c in i)&&i[c]===n)return t||c||0;return!t&&-1}}(!1),V=H("IE_PROTO"),$=function(t,e){var n,r=L(t),o=0,i=[];for(n in r)n!=V&&T(r,n)&&i.push(n);for(;e.length>o;)T(r,n=e[o++])&&(~Y(i,n)||i.push(n));return i},tt="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),et=Object.keys||function(t){return $(t,tt)},nt=b?Object.defineProperties:function(t,e){y(t);for(var n,r=et(e),o=r.length,i=0;o>i;)E.f(t,n=r[i++],e[n]);return t},rt=l.document&&document.documentElement,ot=H("IE_PROTO"),it=function(){},ut=function(){var t,e=w("iframe"),n=tt.length;for(e.style.display="none",rt.appendChild(e),e.src="javascript:",t=e.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),ut=t.F;n--;)delete ut.prototype[tt[n]];return ut()},ct=Object.create||function(t,e){var n;return null!==t?(it.prototype=y(t),n=new it,it.prototype=null,n[ot]=t):n=ut(),void 0===e?n:nt(n,e)},st=e(function(t){var e=B("wks"),n=l.Symbol,r="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=r&&n[t]||(r?n:X)("Symbol."+t))}).store=e}),at=E.f,ft=st("toStringTag"),lt=function(t,e,n){t&&!T(t=n?t:t.prototype,ft)&&at(t,ft,{configurable:!0,value:e})},ht={};P(ht,st("iterator"),function(){return this});var pt=function(t,e,n){t.prototype=ct(ht,{next:M(1,n)}),lt(t,e+" Iterator")},vt=function(t){return Object(f(t))},dt=H("IE_PROTO"),yt=Object.prototype,mt=Object.getPrototypeOf||function(t){return t=vt(t),T(t,dt)?t[dt]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?yt:null},bt=st("iterator"),gt=!([].keys&&"next"in[].keys()),_t=function(){return this},wt=function(t,e,n,r,o,i,u){pt(n,e,r);var c,s,a,f=function(t){if(!gt&&t in v)return v[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},l=e+" Iterator",h="values"==o,p=!1,v=t.prototype,d=v[bt]||v["@@iterator"]||o&&v[o],y=d||f(o),m=o?h?f("entries"):y:void 0,b="Array"==e?v.entries||d:d;if(b&&(a=mt(b.call(new t)))!==Object.prototype&&lt(a,l,!0),h&&d&&"values"!==d.name&&(p=!0,y=function(){return d.call(this)}),u&&(gt||p||!v[bt])&&P(v,bt,y),N[e]=y,N[l]=_t,o)if(c={values:h?y:f("values"),keys:i?y:f("keys"),entries:m},u)for(s in c)s in v||x(v,s,c[s]);else C(C.P+C.F*(gt||p),e,c);return c},Ot=function(t){return function(e,n){var r,o,i=String(f(e)),u=a(n),c=i.length;return u<0||u>=c?t?"":void 0:(r=i.charCodeAt(u),r<55296||r>56319||u+1===c||(o=i.charCodeAt(u+1))<56320||o>57343?t?i.charAt(u):r:t?i.slice(u,u+2):o-56320+(r-55296<<10)+65536)}}(!0);wt(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=Ot(e,n),this._i+=t.length,{value:t,done:!1})});var kt=function(t,e){return{value:e,done:!!t}};wt(Array,"Array",function(t,e){this._t=L(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,kt(1)):"keys"==e?kt(0,n):"values"==e?kt(0,t[n]):kt(0,[n,t[n]])},"values");N.Arguments=N.Array;for(var jt=st("toStringTag"),St=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],Et=0;Et<5;Et++){var Mt=St[Et],Pt=l[Mt],At=Pt&&Pt.prototype;At&&!At[jt]&&P(At,jt,Mt),N[Mt]=N.Array}var Ct=st,xt={f:Ct},Ft=xt.f("iterator"),Tt=e(function(t){t.exports={default:Ft,__esModule:!0}}),Nt=e(function(t){var e=X("meta"),n=E.f,r=0,o=Object.isExtensible||function(){return!0},i=!m(function(){return o(Object.preventExtensions({}))}),u=function(t){n(t,e,{value:{i:"O"+ ++r,w:{}}})},c=function(t,n){if(!d(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!T(t,e)){if(!o(t))return"F";if(!n)return"E";u(t)}return t[e].i},s=function(t,n){if(!T(t,e)){if(!o(t))return!0;if(!n)return!1;u(t)}return t[e].w},a=function(t){return i&&f.NEED&&o(t)&&!T(t,e)&&u(t),t},f=t.exports={KEY:e,NEED:!1,fastKey:c,getWeak:s,onFreeze:a}}),It=E.f,Wt=function(t){var e=h.Symbol||(h.Symbol={});"_"==t.charAt(0)||t in e||It(e,t,{value:xt.f(t)})},Rt=function(t,e){for(var n,r=L(t),o=et(r),i=o.length,u=0;i>u;)if(r[n=o[u++]]===e)return n},Lt=Object.getOwnPropertySymbols,Jt={f:Lt},Dt={}.propertyIsEnumerable,Ut={f:Dt},Zt=function(t){var e=et(t),n=Jt.f;if(n)for(var r,o=n(t),i=Ut.f,u=0;o.length>u;)i.call(t,r=o[u++])&&e.push(r);return e},zt=Array.isArray||function(t){return"Array"==W(t)},qt=tt.concat("length","prototype"),Bt=Object.getOwnPropertyNames||function(t){return $(t,qt)},Gt={f:Bt},Kt=Gt.f,Xt={}.toString,Qt="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Ht=function(t){try{return Kt(t)}catch(t){return Qt.slice()}},Yt=function(t){return Qt&&"[object Window]"==Xt.call(t)?Ht(t):Kt(L(t))},Vt={f:Yt},$t=Object.getOwnPropertyDescriptor,te=b?$t:function(t,e){if(t=L(t),e=k(e,!0),O)try{return $t(t,e)}catch(t){}if(T(t,e))return M(!Ut.f.call(t,e),t[e])},ee={f:te},ne=Nt.KEY,re=ee.f,oe=E.f,ie=Vt.f,ue=l.Symbol,ce=l.JSON,se=ce&&ce.stringify,ae=st("_hidden"),fe=st("toPrimitive"),le={}.propertyIsEnumerable,he=B("symbol-registry"),pe=B("symbols"),ve=B("op-symbols"),de=Object.prototype,ye="function"==typeof ue,me=l.QObject,be=!me||!me.prototype||!me.prototype.findChild,ge=b&&m(function(){return 7!=ct(oe({},"a",{get:function(){return oe(this,"a",{value:7}).a}})).a})?function(t,e,n){var r=re(de,e);r&&delete de[e],oe(t,e,n),r&&t!==de&&oe(de,e,r)}:oe,_e=function(t){var e=pe[t]=ct(ue.prototype);return e._k=t,e},we=ye&&"symbol"==typeof ue.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof ue},Oe=function(t,e,n){return t===de&&Oe(ve,e,n),y(t),e=k(e,!0),y(n),T(pe,e)?(n.enumerable?(T(t,ae)&&t[ae][e]&&(t[ae][e]=!1),n=ct(n,{enumerable:M(0,!1)})):(T(t,ae)||oe(t,ae,M(1,{})),t[ae][e]=!0),ge(t,e,n)):oe(t,e,n)},ke=function(t,e){y(t);for(var n,r=Zt(e=L(e)),o=0,i=r.length;i>o;)Oe(t,n=r[o++],e[n]);return t},je=function(t,e){return void 0===e?ct(t):ke(ct(t),e)},Se=function(t){var e=le.call(this,t=k(t,!0));return!(this===de&&T(pe,t)&&!T(ve,t))&&(!(e||!T(this,t)||!T(pe,t)||T(this,ae)&&this[ae][t])||e)},Ee=function(t,e){if(t=L(t),e=k(e,!0),t!==de||!T(pe,e)||T(ve,e)){var n=re(t,e);return!n||!T(pe,e)||T(t,ae)&&t[ae][e]||(n.enumerable=!0),n}},Me=function(t){for(var e,n=ie(L(t)),r=[],o=0;n.length>o;)T(pe,e=n[o++])||e==ae||e==ne||r.push(e);return r},Pe=function(t){for(var e,n=t===de,r=ie(n?ve:L(t)),o=[],i=0;r.length>i;)!T(pe,e=r[i++])||n&&!T(de,e)||o.push(pe[e]);return o};ye||(ue=function(){if(this instanceof ue)throw TypeError("Symbol is not a constructor!");var t=X(arguments.length>0?arguments[0]:void 0),e=function(n){this===de&&e.call(ve,n),T(this,ae)&&T(this[ae],t)&&(this[ae][t]=!1),ge(this,t,M(1,n))};return b&&be&&ge(de,t,{configurable:!0,set:e}),_e(t)},x(ue.prototype,"toString",function(){return this._k}),ee.f=Ee,E.f=Oe,Gt.f=Vt.f=Me,Ut.f=Se,Jt.f=Pe,xt.f=function(t){return _e(st(t))}),C(C.G+C.W+C.F*!ye,{Symbol:ue});for(var Ae="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),Ce=0;Ae.length>Ce;)st(Ae[Ce++]);for(var Ae=et(st.store),Ce=0;Ae.length>Ce;)Wt(Ae[Ce++]);C(C.S+C.F*!ye,"Symbol",{for:function(t){return T(he,t+="")?he[t]:he[t]=ue(t)},keyFor:function(t){if(we(t))return Rt(he,t);throw TypeError(t+" is not a symbol!")},useSetter:function(){be=!0},useSimple:function(){be=!1}}),C(C.S+C.F*!ye,"Object",{create:je,defineProperty:Oe,defineProperties:ke,getOwnPropertyDescriptor:Ee,getOwnPropertyNames:Me,getOwnPropertySymbols:Pe}),ce&&C(C.S+C.F*(!ye||m(function(){var t=ue();return"[null]"!=se([t])||"{}"!=se({a:t})||"{}"!=se(Object(t))})),"JSON",{stringify:function(t){if(void 0!==t&&!we(t)){for(var e,n,r=[t],o=1;arguments.length>o;)r.push(arguments[o++]);return e=r[1],"function"==typeof e&&(n=e),!n&&zt(e)||(e=function(t,e){if(n&&(e=n.call(this,t,e)),!we(e))return e}),r[1]=e,se.apply(ce,r)}}}),ue.prototype[fe]||P(ue.prototype,fe,ue.prototype.valueOf),lt(ue,"Symbol"),lt(Math,"Math",!0),lt(l.JSON,"JSON",!0),Wt("asyncIterator"),Wt("observable");var xe,Fe,Te,Ne=h.Symbol,Ie=e(function(t){t.exports={default:Ne,__esModule:!0}}),We=e(function(t,e){function n(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var r=n(Tt),o=n(Ie),i="function"==typeof o.default&&"symbol"==typeof r.default?function(t){return typeof t}:function(t){return t&&"function"==typeof o.default&&t.constructor===o.default&&t!==o.default.prototype?"symbol":typeof t};e.default="function"==typeof o.default&&"symbol"===i(r.default)?function(t){return void 0===t?"undefined":i(t)}:function(t){return t&&"function"==typeof o.default&&t.constructor===o.default&&t!==o.default.prototype?"symbol":void 0===t?"undefined":i(t)}}),Re=t(We),Le=st("toStringTag"),Je="Arguments"==W(function(){return arguments}()),De=function(t,e){try{return t[e]}catch(t){}},Ue=function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=De(e=Object(t),Le))?n:Je?W(e):"Object"==(r=W(e))&&"function"==typeof e.callee?"Arguments":r},Ze=function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!");return t},ze=function(t,e,n,r){try{return r?e(y(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&y(o.call(t)),e}},qe=st("iterator"),Be=Array.prototype,Ge=function(t){return void 0!==t&&(N.Array===t||Be[qe]===t)},Ke=st("iterator"),Xe=h.getIteratorMethod=function(t){if(void 0!=t)return t[Ke]||t["@@iterator"]||N[Ue(t)]},Qe=e(function(t){var e={},n={},r=t.exports=function(t,r,o,i,u){var c,s,a,f,l=u?function(){return t}:Xe(t),h=v(o,i,r?2:1),p=0;if("function"!=typeof l)throw TypeError(t+" is not iterable!");if(Ge(l)){for(c=D(t.length);c>p;p++)if((f=r?h(y(s=t[p])[0],s[1]):h(t[p]))===e||f===n)return f}else for(a=l.call(t);!(s=a.next()).done;)if((f=ze(a,h,s.value,r))===e||f===n)return f};r.BREAK=e,r.RETURN=n}),He=st("species"),Ye=function(t,e){var n,r=y(t).constructor;return void 0===r||void 0==(n=y(r)[He])?e:p(n)},Ve=function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)},$e=l.process,tn=l.setImmediate,en=l.clearImmediate,nn=l.MessageChannel,rn=0,on={},un=function(){var t=+this;if(on.hasOwnProperty(t)){var e=on[t];delete on[t],e()}},cn=function(t){un.call(t.data)};tn&&en||(tn=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return on[++rn]=function(){Ve("function"==typeof t?t:Function(t),e)},xe(rn),rn},en=function(t){delete on[t]},"process"==W($e)?xe=function(t){$e.nextTick(v(un,t,1))}:nn?(Fe=new nn,Te=Fe.port2,Fe.port1.onmessage=cn,xe=v(Te.postMessage,Te,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(xe=function(t){l.postMessage(t+"","*")},l.addEventListener("message",cn,!1)):xe="onreadystatechange"in w("script")?function(t){rt.appendChild(w("script")).onreadystatechange=function(){rt.removeChild(this),un.call(t)}}:function(t){setTimeout(v(un,t,1),0)});var sn={set:tn,clear:en},an=sn.set,fn=l.MutationObserver||l.WebKitMutationObserver,ln=l.process,hn=l.Promise,pn="process"==W(ln),vn=function(t,e,n){for(var r in e)n&&t[r]?t[r]=e[r]:P(t,r,e[r]);return t},dn=st("species"),yn=st("iterator"),mn=!1;try{var bn=[7][yn]();bn.return=function(){mn=!0},Array.from(bn,function(){throw 2})}catch(t){}var gn,_n,wn,On=sn.set,kn=function(){var t,e,n,r=function(){var r,o;for(pn&&(r=ln.domain)&&r.exit();t;){o=t.fn,t=t.next;try{o()}catch(r){throw t?n():e=void 0,r}}e=void 0,r&&r.enter()};if(pn)n=function(){ln.nextTick(r)};else if(fn){var o=!0,i=document.createTextNode("");new fn(r).observe(i,{characterData:!0}),n=function(){i.data=o=!o}}else if(hn&&hn.resolve){var u=hn.resolve();n=function(){u.then(r)}}else n=function(){an.call(l,r)};return function(r){var o={fn:r,next:void 0};e&&(e.next=o),t||(t=o,n()),e=o}}(),jn=l.TypeError,Sn=l.process,En=l.Promise,Sn=l.process,Mn="process"==Ue(Sn),Pn=function(){},An=!!function(){try{var t=En.resolve(1),e=(t.constructor={})[st("species")]=function(t){t(Pn,Pn)};return(Mn||"function"==typeof PromiseRejectionEvent)&&t.then(Pn)instanceof e}catch(t){}}(),Cn=function(t,e){return t===e||t===En&&e===wn},xn=function(t){var e;return!(!d(t)||"function"!=typeof(e=t.then))&&e},Fn=function(t){return Cn(En,t)?new Tn(t):new _n(t)},Tn=_n=function(t){var e,n;this.promise=new t(function(t,r){if(void 0!==e||void 0!==n)throw jn("Bad Promise constructor");e=t,n=r}),this.resolve=p(e),this.reject=p(n)},Nn=function(t){try{t()}catch(t){return{error:t}}},In=function(t,e){if(!t._n){t._n=!0;var n=t._c;kn(function(){for(var r=t._v,o=1==t._s,i=0;n.length>i;)!function(e){var n,i,u=o?e.ok:e.fail,c=e.resolve,s=e.reject,a=e.domain;try{u?(o||(2==t._h&&Ln(t),t._h=1),!0===u?n=r:(a&&a.enter(),n=u(r),a&&a.exit()),n===e.promise?s(jn("Promise-chain cycle")):(i=xn(n))?i.call(n,c,s):c(n)):s(r)}catch(t){s(t)}}(n[i++]);t._c=[],t._n=!1,e&&!t._h&&Wn(t)})}},Wn=function(t){On.call(l,function(){var e,n,r,o=t._v;if(Rn(t)&&(e=Nn(function(){Mn?Sn.emit("unhandledRejection",o,t):(n=l.onunhandledrejection)?n({promise:t,reason:o}):(r=l.console)&&r.error&&r.error("Unhandled promise rejection",o)}),t._h=Mn||Rn(t)?2:1),t._a=void 0,e)throw e.error})},Rn=function(t){if(1==t._h)return!1;for(var e,n=t._a||t._c,r=0;n.length>r;)if(e=n[r++],e.fail||!Rn(e.promise))return!1;return!0},Ln=function(t){On.call(l,function(){var e;Mn?Sn.emit("rejectionHandled",t):(e=l.onrejectionhandled)&&e({promise:t,reason:t._v})})},Jn=function(t){var e=this;e._d||(e._d=!0,e=e._w||e,e._v=t,e._s=2,e._a||(e._a=e._c.slice()),In(e,!0))},Dn=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw jn("Promise can't be resolved itself");(e=xn(t))?kn(function(){var r={_w:n,_d:!1};try{e.call(t,v(Dn,r,1),v(Jn,r,1))}catch(t){Jn.call(r,t)}}):(n._v=t,n._s=1,In(n,!1))}catch(t){Jn.call({_w:n,_d:!1},t)}}};An||(En=function(t){Ze(this,En,"Promise","_h"),p(t),gn.call(this);try{t(v(Dn,this,1),v(Jn,this,1))}catch(t){Jn.call(this,t)}},gn=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},gn.prototype=vn(En.prototype,{then:function(t,e){var n=Fn(Ye(this,En));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=Mn?Sn.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&In(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),Tn=function(){var t=new gn;this.promise=t,this.resolve=v(Dn,t,1),this.reject=v(Jn,t,1)}),C(C.G+C.W+C.F*!An,{Promise:En}),lt(En,"Promise"),function(t){var e="function"==typeof h[t]?h[t]:l[t];b&&e&&!e[dn]&&E.f(e,dn,{configurable:!0,get:function(){return this}})}("Promise"),wn=h.Promise,C(C.S+C.F*!An,"Promise",{reject:function(t){var e=Fn(this);return(0,e.reject)(t),e.promise}}),C(C.S+!0*C.F,"Promise",{resolve:function(t){if(t instanceof En&&Cn(t.constructor,this))return t;var e=Fn(this);return(0,e.resolve)(t),e.promise}}),C(C.S+C.F*!(An&&function(t,e){if(!e&&!mn)return!1;var n=!1;try{var r=[7],o=r[yn]();o.next=function(){return{done:n=!0}},r[yn]=function(){return o},t(r)}catch(t){}return n}(function(t){En.all(t).catch(Pn)})),"Promise",{all:function(t){var e=this,n=Fn(e),r=n.resolve,o=n.reject,i=Nn(function(){var n=[],i=0,u=1;Qe(t,!1,function(t){var c=i++,s=!1;n.push(void 0),u++,e.resolve(t).then(function(t){s||(s=!0,n[c]=t,--u||r(n))},o)}),--u||r(n)});return i&&o(i.error),n.promise},race:function(t){var e=this,n=Fn(e),r=n.reject,o=Nn(function(){Qe(t,!1,function(t){e.resolve(t).then(n.resolve,r)})});return o&&r(o.error),n.promise}});var Un=h.Promise,Zn=e(function(t){t.exports={default:Un,__esModule:!0}}),zn=t(Zn),qn=e(function(t,e){e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}}),Bn=t(qn);C(C.S+C.F*!b,"Object",{defineProperty:E.f});var Gn=h.Object,Kn=function(t,e,n){return Gn.defineProperty(t,e,n)},Xn=e(function(t){t.exports={default:Kn,__esModule:!0}}),Qn=e(function(t,e){e.__esModule=!0;var n=function(t){return t&&t.__esModule?t:{default:t}}(Xn);e.default=function(){function t(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),(0,n.default)(t,o.key,o)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}()}),Hn=t(Qn),Yn=st("species"),Vn=function(t){var e;return zt(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!zt(e.prototype)||(e=void 0),d(e)&&null===(e=e[Yn])&&(e=void 0)),void 0===e?Array:e},$n=function(t,e){return new(Vn(t))(e)},tr=function(t,e){var n=1==t,r=2==t,o=3==t,i=4==t,u=6==t,c=5==t||u,s=e||$n;return function(e,a,f){for(var l,h,p=vt(e),d=R(p),y=v(a,f,3),m=D(d.length),b=0,g=n?s(e,m):r?s(e,0):void 0;m>b;b++)if((c||b in d)&&(l=d[b],h=y(l,b,p),t))if(n)g[b]=h;else if(h)switch(t){case 3:return!0;case 5:return l;case 6:return b;case 2:g.push(l)}else if(i)return!1;return u?-1:o||i?i:g}},er=Object.assign,nr=!er||m(function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach(function(t){e[t]=t}),7!=er({},t)[n]||Object.keys(er({},e)).join("")!=r})?function(t,e){for(var n=vt(t),r=arguments.length,o=1,i=Jt.f,u=Ut.f;r>o;)for(var c,s=R(arguments[o++]),a=i?et(s).concat(i(s)):et(s),f=a.length,l=0;f>l;)u.call(s,c=a[l++])&&(n[c]=s[c]);return n}:er,rr=Nt.getWeak,or=tr(5),ir=tr(6),ur=0,cr=function(t){return t._l||(t._l=new sr)},sr=function(){this.a=[]},ar=function(t,e){return or(t.a,function(t){return t[0]===e})};sr.prototype={get:function(t){var e=ar(this,t);if(e)return e[1]},has:function(t){return!!ar(this,t)},set:function(t,e){var n=ar(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(t){var e=ir(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}};var fr={getConstructor:function(t,e,n,r){var o=t(function(t,i){Ze(t,o,e,"_i"),t._i=ur++,t._l=void 0,void 0!=i&&Qe(i,n,t[r],t)});return vn(o.prototype,{delete:function(t){if(!d(t))return!1;var e=rr(t);return!0===e?cr(this).delete(t):e&&T(e,this._i)&&delete e[this._i]},has:function(t){if(!d(t))return!1;var e=rr(t);return!0===e?cr(this).has(t):e&&T(e,this._i)}}),o},def:function(t,e,n){var r=rr(y(e),!0);return!0===r?cr(t).set(e,n):r[t._i]=n,t},ufstore:cr},lr=E.f,hr=tr(0),pr=function(t,e,n,r,o,i){var u=l[t],c=u,s=o?"set":"add",a=c&&c.prototype,f={};return b&&"function"==typeof c&&(i||a.forEach&&!m(function(){(new c).entries().next()}))?(c=e(function(e,n){Ze(e,c,t,"_c"),e._c=new u,void 0!=n&&Qe(n,o,e[s],e)}),hr("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(t){var e="add"==t||"set"==t;t in a&&(!i||"clear"!=t)&&P(c.prototype,t,function(n,r){if(Ze(this,c,t),!e&&i&&!d(n))return"get"==t&&void 0;var o=this._c[t](0===n?0:n,r);return e?this:o})}),"size"in a&&lr(c.prototype,"size",{get:function(){return this._c.size}})):(c=r.getConstructor(e,t,o,s),vn(c.prototype,n),Nt.NEED=!0),lt(c,t),f[t]=c,C(C.G+C.W+C.F,f),i||r.setStrong(c,t,o),c},vr=(e(function(t){var e,n=tr(0),r=Nt.getWeak,o=Object.isExtensible,i=fr.ufstore,u={},c=function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}},s={get:function(t){if(d(t)){var e=r(t);return!0===e?i(this).get(t):e?e[this._i]:void 0}},set:function(t,e){return fr.def(this,t,e)}},a=t.exports=pr("WeakMap",c,s,fr,!0,!0);7!=(new a).set((Object.freeze||Object)(u),7).get(u)&&(e=fr.getConstructor(c),nr(e.prototype,s),Nt.NEED=!0,n(["delete","has","get","set"],function(t){var n=a.prototype,r=n[t];x(n,t,function(n,i){if(d(n)&&!o(n)){this._f||(this._f=new e);var u=this._f[t](n,i);return"set"==t?this:u}return r.call(this,n,i)})}))}),h.WeakMap),dr=e(function(t){t.exports={default:vr,__esModule:!0}}),yr=t(dr);if(void 0===window.postMessage)throw new Error("The Flat Embed JS API is not supported in this browser");!function(t,e){var n=(h.Object||{})[t]||Object[t],r={};r[t]=e(n),C(C.S+C.F*m(function(){n(1)}),"Object",r)}("keys",function(){return function(t){return et(vt(t))}});var mr=h.Object.keys,br=e(function(t){t.exports={default:mr,__esModule:!0}}),gr=t(br);C(C.S+C.F,"Object",{assign:nr});var _r=h.Object.assign,wr=e(function(t){t.exports={default:_r,__esModule:!0}}),Or=t(wr),kr=function(){function t(e){return Bn(this,t),this.embed=e,this.promises={},this.eventCallbacks={},this}return Hn(t,[{key:"pushCall",value:function(t,e,n){this.promises[t]=this.promises[t]||[],this.promises[t].push({resolve:e,reject:n})}},{key:"subscribeEvent",value:function(t,e){return this.eventCallbacks[t]=this.eventCallbacks[t]||[],this.eventCallbacks[t].push(e),1===this.eventCallbacks[t].length}},{key:"unsubscribeEvent",value:function(t,e){if(!this.eventCallbacks[t])return!1;if(e){var n=this.eventCallbacks[t].indexOf(e);n>=0&&this.eventCallbacks[t].splice(n,1)}else this.eventCallbacks[t]=[];return!e||0===this.eventCallbacks[t].length}},{key:"process",value:function(t){t.method?this.processMethodResponse(t):t.event&&this.processEvent(t)}},{key:"processMethodResponse",value:function(t){var e=this.promises[t.method].shift();e&&(t.error?e.reject(t.error):e.resolve(t.response))}},{key:"processEvent",value:function(t){var e=this;this.eventCallbacks[t.event]&&0!==this.eventCallbacks[t.event].length&&this.eventCallbacks[t.event].forEach(function(n){n.call(e.embed,t.parameters)})}}]),t}(),jr=new yr,Sr=new yr;return function(){function Embed(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Bn(this,Embed),t=n(t),jr.has(t))return jr.get(t);"IFRAME"!==t.nodeName&&(t=o(t,r)),this.origin="*",this.element=t,this.embedCallback=new kr;var c=new zn(function(n){var r=function(r){if(t.contentWindow===r.source){"*"===e.origin&&(e.origin=r.origin);var o=u(r.data);if("ready"===o.event||"ping"===o.method)return void n();e.embedCallback.process(o)}};window.addEventListener("message",r,!1),i(e,"ping")});return jr.set(this.element,this),Sr.set(this,c),this}return Hn(Embed,[{key:"ready",value:function(){return zn.resolve(Sr.get(this))}},{key:"call",value:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new zn(function(r,o){return e.ready().then(function(){e.embedCallback.pushCall(t,r,o),i(e,t,n)})})}},{key:"on",value:function(t,e){if("string"!=typeof t)throw new TypeError("An event name (string) is required");if("function"!=typeof e)throw new TypeError("An callback (function) is required");this.embedCallback.subscribeEvent(t,e)&&this.call("addEventListener",t).catch(function(){})}},{key:"off",value:function(t,e){if("string"!=typeof t)throw new TypeError("An event name (string) is required");this.embedCallback.unsubscribeEvent(t,e)&&this.call("removeEventListener",t).catch(function(){})}},{key:"loadFlatScore",value:function(t,e){return this.call("loadFlatScore",{score:t,revision:e})}},{key:"loadMusicXML",value:function(t){return this.call("loadMusicXML",t)}},{key:"loadJSON",value:function(t){return this.call("loadJSON",t)}},{key:"getJSON",value:function(){return this.call("getJSON")}},{key:"getMusicXML",value:function(t){var e=this;return new zn(function(n,r){if(t=t||{},"object"!==(void 0===t?"undefined":Re(t)))return r(new TypeError("Options must be an object"));e.call("getMusicXML",t).then(function(t){return n("string"==typeof t?t:new Uint8Array(t.data))}).catch(r)})}},{key:"getFlatScoreMetadata",value:function(){return this.call("getFlatScoreMetadata")}},{key:"fullscreen",value:function(t){return this.call("fullscreen",t)}},{key:"play",value:function(){return this.call("play")}},{key:"pause",value:function(){return this.call("pause")}},{key:"stop",value:function(){return this.call("stop")}},{key:"print",value:function(){return this.call("print")}},{key:"getZoom",value:function(){return this.call("getZoom")}},{key:"setZoom",value:function(t){return this.call("setZoom",t)}},{key:"getAutoZoom",value:function(){return this.call("getAutoZoom")}},{key:"setAutoZoom",value:function(t){return this.call("setAutoZoom",t)}}]),Embed}()});
